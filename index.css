/* Hide player title if empty */
.player-title:empty {
  display: none !important;
}
/* =============================================================
   Media Player Stylesheet (refactored ordering)
   -------------------------------------------------------------
   Table of Contents
   1. Root Variables
   2. Base / Resets
   3. Utilities
   4. Layout Primitives (grid, cards, generic components)
   5. Buttons & Controls
   6. Performers Panel
   7. Modals / Overlays
   8. Tabs & Sections (Tasks, Artifacts, Jobs)
   9. Selection & Badges
   10. Artifact Cards & Options Tooltip
   11. Job Monitor (stats, tables)
   12. Orphaned Artifacts
   13. Accordion
   14. Player (Simplified + Full Tab)
   15. Viewport Fit Player Adjustments
   16. Toast / Notifications
   17. Animations & Keyframes
   -------------------------------------------------------------
   Notes:
   * Nested selectors previously inside #folderInput were flattened.
   * Duplicate .btn-sm size variant inside controls panel is now scoped.
   * Duplicate @keyframes spin removed (single canonical definition).
   * Second slideIn variant renamed slideInRight for clarity.
   ============================================================= */

/* 1. Root Variables */
/* Restored canonical design token set (was accidentally removed during cleanup) */
:root {
  /* Core palette */
  --bg: #0d1117;
  --panel: #152030;
  --card: #1d2737;
  --card-bg: #1d2737;
  --card-hover: #243247;
  --text: #dbe2f1;
  --muted: #94a2c7;
  --accent: #4f8cff;
  --success: #22c55e;
  --danger: #ef4444;
  --warn: #f59e0b;

  /* Layout / shape */
  --radius-sm: 4px;
  --radius: 8px;
  --radius-lg: 14px;
  --header-h: 54px; /* unified with later viewport-fit section */
  /* --player-split-h removed: using flex-based natural height now */

  /* Motion & effects */
  --transition: .2s cubic-bezier(.4,.2,.2,1);
  --focus-ring: 0 0 0 2px rgba(79,140,255,.5);
  /* Removed fixed player height variable; full flex-based height now */
  --player-sidebar-w: 300px; /* fixed sidebar width so right panel handles horizontal resize */
}

/* 2. Base / Resets */
* { 
  box-sizing: border-box; 
}

html, 
body { 
  height: 100%; 
}

body {
  margin: 0;
  font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Inter, "Helvetica Neue", Arial, "Apple Color Emoji", "Segoe UI Emoji";
  background: var(--bg);
  color: var(--text);
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
}

/* Hide native scrollbars (while preserving scroll functionality) */
html, body, .tab-panels, .tab-panel {
  scrollbar-width: none; /* Firefox */
}
html::-webkit-scrollbar,
body::-webkit-scrollbar,
.tab-panels::-webkit-scrollbar,
.tab-panel::-webkit-scrollbar { width: 0; height: 0; }

/* Globally hide WebKit scrollbars (extra safeguard) */
::-webkit-scrollbar { display: none !important; width: 0; height: 0; }


header {
  position: sticky;
  top: 0;
  z-index: 10;
  padding: 10px 18px 6px;
  background: rgba(15, 17, 21, 0.75);
  backdrop-filter: blur(8px);
  border-bottom: 1px solid #242938;
}

main {
  padding: 0 64px; /* remove vertical padding so panels can truly fill viewport */
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0; /* allow inner panels to control scrolling */
}

/* 3. Utilities */
.d-none,
.hidden {
  display: none !important;
}

.ml-auto {
  margin-left: auto !important;
}

.fw-600 {
  font-weight: 600;
}

.hint-sm {
  color: var(--muted);
  font-size: 12px;
  line-height: 1.4;
}

.mt-12 {
  margin-top: 12px;
}

.gap-10 {
  gap: 10px;
}

.gap-16 {
  gap: 16px;
}

.flex-row {
  display: flex;
  align-items: center;
}

.w-120 {
  width: 120px;
}

.w-100 {
  width: 100%;
}

/* Core inputs */
#folderInput {
  background: var(--panel);
  color: var(--text);
  border: 2px solid #2a3144;
  border-radius: 10px;
  padding: 10px 14px;
  font-size: 14px;
  outline: none;
  width: 100%;
  transition: all 0.2s ease;
}

#folderInput:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 3px rgba(79, 140, 255, 0.2);
  transform: translateY(-1px);
}

#folderInput::placeholder {
  color: var(--muted);
}

/* 4. Layout Primitives */
.grid {
  display: grid;
  grid-template-columns: repeat(var(--columns, 6), 1fr);
  gap: var(--grid-gap);
  margin: 0 64px;
}

.card {
  background: var(--card);
  border: 1px solid #2a3144;
  border-radius: 10px;
  overflow: hidden;
  transition: background .15s ease, transform .06s ease;
  position: relative;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.card:hover {
  background: var(--card-hover);
  transform: translateY(-1px);
}

/* Visual state while an on-demand hover/preview is being generated */
.card.hover-generating {
  outline: 2px dashed rgba(79,140,255,0.25);
}

/* 5. Buttons & Controls (core) */
.btn {
  background: var(--panel);
  color: var(--text);
  border: 2px solid #2a3144;
  border-radius: 12px;
  padding: 12px 16px;
  font-size: 16px;
  cursor: pointer;
  font-weight: 600;
  transition: all 0.2s ease;
}

.btn:hover {
  background: #1a2030;
  border-color: var(--accent);
  transform: translateY(-1px);
}

/* Base small button */
.btn-sm {
  background: var(--panel);
  color: var(--text);
  border: 1px solid #2a3144;
  border-radius: 8px;
  padding: 6px 10px;
  font-size: 12px;
  font-weight: 600;
  cursor: pointer;
  display: inline-flex;
  align-items: center;
  gap: 4px;
  transition: all 0.2s ease;
}

.btn-sm:hover {
  background: #1e2634;
  border-color: #364258;
}

.btn-sm:active {
  background: #16202d;
}

.btn-sm.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #fff;
}

/* Scoped larger variant previously overriding global .btn-sm */
.controls-panel .btn-sm {
  background: var(--bg);
  color: var(--text);
  border: 1px solid #2a3144;
  border-radius: 8px;
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 500;
  height: 40px;
  display: flex;
  align-items: center;
  justify-content: center;
}

.controls-panel .btn-sm:hover {
  background: var(--card);
  border-color: var(--accent);
  box-shadow: 0 2px 4px rgba(79, 140, 255, 0.2);
}

.controls-panel .btn-sm.active {
  background: var(--accent);
  border-color: var(--accent);
  color: #fff;
}

/* Busy state */
.btn-busy,
.btn.btn-busy,
.btn-sm.btn-busy {
  position: relative;
  pointer-events: none;
  opacity: .9;
}

.btn-busy::before {
  content: "";
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 8px;
  border: 2px solid rgba(255, 255, 255, 0.4);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.9s linear infinite;
  vertical-align: -2px;
}

/* Destructive */
.btn-danger,
.btn.btn-danger,
button.btn-danger {
  background: linear-gradient(135deg, #b91c1c, #dc2626);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.12);
  box-shadow: 0 2px 4px -2px rgba(0, 0, 0, 0.5);
}

.btn-danger:hover {
  background: linear-gradient(135deg, #dc2626, #ef4444);
}

.btn-danger:active {
  background: #991b1b;
}

.btn-danger:disabled {
  opacity: .55;
  cursor: not-allowed;
}

/* 6. Performers Panel (moved & consolidated) */
#performers-panel {
  overflow-x: hidden;
}

#performers-panel .perf-grid {
  overflow-x: hidden;
  width: 100%;
  max-width: 100%;
}
.marker-time-label { font-variant-numeric: tabular-nums; }
.marker-time-label--editable { cursor: pointer; user-select: none; }
.marker-time-label--editable:hover { text-decoration: underline; }
.marker-name-label { flex: 1; min-width: 0; font-weight: 500; }
.marker-name-label--editable { cursor: pointer; user-select: none; }
.marker-name-label--editable:hover { text-decoration: underline; }
.marker-name-input { flex: 1; min-width: 0; padding: 2px 4px; font-size: 12px; }

.perf-grid {
  box-sizing: border-box;
  --card-bg: #141b28;
}

.perf-grid.loading {
  opacity: .55;
  pointer-events: none;
}

.perf-card {
  min-width: 0;
  position: relative;
  display: flex;
  flex-direction: column;
  gap: 6px;
  padding: 12px 12px 10px;
  background: var(--card-bg);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 10px;
  box-shadow: 0 2px 6px -2px rgba(0, 0, 0, 0.5);
  min-height: 96px;
  max-width: 100%;
}

.perf-card[data-selected="1"] {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.perf-card h3 {
  margin: 0;
  font-size: 14px;
  font-weight: 600;
  line-height: 1.2;
  word-break: break-word;
  overflow-wrap: break-word;
}

.perf-card .count {
  font-size: 11px;
  opacity: .65;
}

.perf-card .actions {
  display: flex;
  gap: 6px;
  margin-top: auto;
}

.perf-card button.btn-xs {
  font-size: 11px;
  padding: 3px 6px;
  line-height: 1.1;
}

.perf-card .tags {
  display: flex;
  flex-wrap: wrap;
  gap: 4px;
}

.perf-card .tag {
  font-size: 10px;
  padding: 2px 5px;
  background: #1f2b3b;
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 4px;
}

@media (max-width: 640px) {
  .perf-grid {
    grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
    gap: 10px;
  }

  .perf-card {
    padding: 10px 10px 8px;
  }
}

/* Preserve existing (rest of file below remains in original relative order, minus removed nested block & duplicates) */
#performers-panel .perf-card h3 {
  word-break: break-word;
  overflow-wrap: break-word;
}

/* ORIGINAL CONTENT CONTINUES (unreordered beyond critical fixes) */

#playerControls .btn-sm {
  height: 20px;
  padding: 1px 5px;
  font-size: 10.5px;
}

#playerControls select.control-select {
  height: 20px;
  padding: 1px 16px 1px 5px;
  font-size: 10.5px;
}

#playerControls input[type="range"] {
  height: 3px;
}

/* (Duplicate :root and utility class definitions removed; see top of file) */

/* Extracted from former inline styles */
.embed-extra {
  margin-top: 8px;
  padding-top: 8px;
  border-top: 1px solid rgba(255, 255, 255, 0.08);
}

.orphan-details {
  font-size: 13px;
  line-height: 1.5;
}

.task-section-spaced {
  margin-top: 12px;
}

.file-selection-root {
  padding: 12px 0;
  display: flex;
  flex-direction: column;
  gap: 10px;
}

.root-input-row {
  display: flex;
  gap: 10px;
  align-items: center;
  width: 100%;
}

.root-input {
  flex: 1;
}

.file-selection-compact {
  padding: 12px 0;
}

.selection-option-wide {
  gap: 10px;
  align-items: flex-start;
}

.subtitle-icon-label {
  font-weight: 600;
  display: flex;
  align-items: center;
  gap: 8px;
}

.subtitle-icon {
  display: inline-block;
  width: 16px;
  height: 12px;
  border-radius: 3px;
  background: #2c323d;
  position: relative;
  overflow: hidden;
}

.subtitle-line {
  position: absolute;
  left: 2px;
  right: 2px;
  height: 3px;
  background: #12161f;
  border-radius: 2px;
}

.subtitle-line.top {
  top: 3px;
}

.subtitle-line.bottom {
  bottom: 3px;
  left: 6px;
}

/* Registry column narrow variant (used by tags panel) */
.registry-column--narrow { max-width: 640px; }

/* Image modal specific helpers */
.panel--image-body { padding: 0; background: #0e1016; }
.panel-image { display: block; max-width: 100%; height: auto; }


.sprite-defs-hidden {
  position: absolute;
  left: -9999px;
  visibility: hidden;
}

.fw-600 {
  font-weight: 600;
}

.hint-sm {
  color: var(--muted);
  font-size: 12px;
  line-height: 1.4;
}

.mt-12 {
  margin-top: 12px;
}

.gap-10 {
  gap: 10px;
}

.gap-16 {
  gap: 16px;
}

.flex-row {
  display: flex;
  align-items: center;
}

.w-120 {
  width: 120px;
}

.w-100 {
  width: 100%;
}

.file-selection-inline {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 16px;
}

.control-group--flex { min-width:160px; max-width:240px; flex:1; }

/* spritePreview positioning and visuals moved from inline style */
#spritePreview {
  position: absolute;
  display: none;
  background-repeat: no-repeat;
  background-color: rgba(0,0,0,0.55);
  border: 1px solid rgba(255,255,255,0.2);
  box-shadow: 0 4px 14px -4px rgba(0,0,0,0.7), 0 0 0 1px rgba(255,255,255,0.08) inset;
  border-radius: 6px;
  overflow: hidden;
  backdrop-filter: blur(4px) saturate(140%);
}

.ml-8 { margin-left: 8px; }
.ml-4 { margin-left: 4px; }

/* Sidebar toggle handle (vertical) */
.sidebar-toggle {
  position: relative;
  z-index: 30;
  background: transparent;
  border: 1px solid var(--border-color, rgba(255,255,255,0.06));
  border-radius: 6px;
  display: inline-flex;
  align-items: center;
  justify-content: center;
  cursor: pointer;
  padding: 0 8px; /* horizontal padding only so height is governed by siblings */
  transition: background .15s ease, border-color .15s ease;
  align-self: stretch; /* match height of sibling panels */
  box-sizing: border-box;
}
.sidebar-toggle:hover { background: rgba(255,255,255,0.02); }
.sidebar-toggle:focus { outline: none; box-shadow: var(--focus-ring); overflow: visible; z-index: 60; }
.sidebar-toggle:hover { overflow: visible; z-index: 50; }
.sidebar-toggle__icon {
  display: block;
  width: 16px;
  height: 16px;
  transition: transform 220ms ease, color 150ms ease, opacity 150ms ease;
  color: var(--muted);
  transform-origin: center center;
}
.sidebar-toggle svg { display: block; width: 16px; height: 16px; }
.sidebar-toggle__icon use,
.sidebar-toggle__icon path,
.sidebar-toggle__icon svg { stroke: none !important; fill: currentColor !important; }
.sidebar-toggle__icon { opacity: 1; }
.sidebar-toggle__fallback { display: none; }

/* If the UA doesn't apply <use>, show the fallback path */
.sidebar-toggle__icon:not(:has(use)) .sidebar-toggle__fallback { display: block; }

/* Make the toggle icon more visible and responsive to hover/active states */
.sidebar-toggle { color: var(--text); }
.sidebar-toggle:hover { color: color-mix(in srgb, var(--text) 85%, var(--accent) 15%); }
.sidebar-toggle:active { color: var(--accent); }

/* Sidebar child contents transition for smooth collapse */
.player-split .player-sidebar > * { transition: opacity 190ms ease, transform 220ms ease; }
.has-sidebar-collapsed .player-split .player-sidebar > * { opacity: 0; transform: translateX(-6px); pointer-events: none; }

/* Ensure player-main expands to fill when sidebar collapsed */
.player-split { display:flex; gap:12px; align-items:stretch; overflow: visible; }
.player-sidebar { width: 320px; transition: width .18s ease, padding .15s ease; }
.player-main { flex:1 1 auto; }

/* Make the toggle a stable flex sibling so it remains visible when sidebar is display:none */
.sidebar-toggle { flex: 0 0 auto; align-self: stretch; display:flex; align-items:center; padding: 8px; z-index: 40; border: 1px solid var(--border-color, rgba(255,255,255,0.06)); border-radius:6px; overflow: visible; }


/* Performers toolbar & dropzone */
.perf-toolbar {
  display: flex;
  gap: 10px;
  align-items: center;
  flex-wrap: wrap;
  margin: 0 0 8px;
}

.perf-search {
  flex: 1 1 200px;
  min-width: 200px;
}

.performer-dropzone {
  border: 1px dashed rgba(255, 255, 255, 0.25);
  border-radius: 8px;
  padding: 14px;
  text-align: center;
  font-size: 13px;
  color: #94a2c7;
  margin: 0 0 8px;
  cursor: pointer;
  user-select: none;
}

.performer-dropzone:hover {
  background: rgba(255, 255, 255, 0.03);
}

.pdz-title {
  display: block;
  font-weight: 600;
  color: #b9c6e4;
  margin: 0 0 2px;
}

.pdz-sub {
  display: block;
  font-size: 12px;
  opacity: 0.85;
}

.performers-status {
  font-size: 12px;
  color: #8894b0;
  margin: 0 0 6px;
}

.performers-grid {
  position: relative;
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(180px, 1fr));
  gap: 14px;
  padding: 4px;
  min-height: 240px;
  overflow-y: auto;
  overflow-x: hidden;
}

/* Task / artifact utility replacements */
.options-tooltip.d-none {
  display: none !important;
}

/* (Duplicate base reset + button/grid/card definitions removed above for clarity) */

/* Video hover preview */
.video-hover-preview {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  z-index: 100;
  pointer-events: none;
  opacity: 0;
  transition: opacity 0.2s ease;
}

/* Player overlay adjustments */
#playerContainer .player-video {
  position: relative;
}

#timeline {
  z-index: 5;
}

/* Position of #spritePreview is controlled by JS; keep only z-index here */
#spritePreview {
  z-index: 6;
}

.video-hover-preview.active {
  opacity: 1;
}

.video-hover-preview video {
  width: 100%;
  height: 100%;
  object-fit: cover;
  border-radius: 9px;
  /* Slightly smaller than card to stay within borders */
}

/* Hover toggle button styling */
.btn-sm.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.thumb-wrap {
  position: relative;
}

.thumb {
  aspect-ratio: 16/9;
  width: 100%;
  display: block;
  background: #0e0f14;
  object-fit: cover;
}

.meta {
  padding: 8px 10px 10px;
}

.title {
  font-size: 13px;
  font-weight: 600;
  line-height: 1.35;
  margin: 0 0 4px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.sub {
  font-size: 12px;
  color: var(--muted);
}

.empty,
.error {
  color: var(--muted);
  padding: 24px;
  text-align: center;
}

.overlay-info {
  position: absolute;
  right: 8px;
  bottom: 8px;
  z-index: 9;
  display: none;
  padding: 1px 5px;
  border-radius: 4px;
  background: rgba(0, 0, 0, 0.35);
  line-height: 1;
}

.overlay-info .overlay-resolution {
  font-weight: 800;
  color: #ffffff;
  letter-spacing: 0.2px;
  text-transform: uppercase;
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.45);
  font-size: 11px;
}

.spinner {
  position: fixed;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  z-index: 1000;
}

.spinner::after {
  content: "";
  width: 40px;
  height: 40px;
  border: 3px solid var(--muted);
  border-top: 3px solid var(--accent);
  border-radius: 50%;
  animation: spin 1s linear infinite;
}

@keyframes spin {
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
}

.row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 8px;
}

.job-progress {
  position: relative;
  width: 100%;
  height: 8px;
  background: #20263a;
  border-radius: 6px;
  overflow: hidden;
  border: 1px solid #2a3144;
}

.job-progress-fill {
  height: 100%;
  width: 0%;
  background: linear-gradient(90deg, var(--accent), #7aa6ff);
  transition: width 0.25s ease;
}

.job-progress.running .job-progress-fill {
  background-color: var(--accent);
  background-image: repeating-linear-gradient(-45deg,
      rgba(255, 255, 255, 0.25) 0,
      rgba(255, 255, 255, 0.25) 10px,
      transparent 10px,
      transparent 20px);
  animation: progress-stripes 1.2s linear infinite;
}

@keyframes progress-stripes {
  from {
    background-position: 0 0;
  }

  to {
    background-position: 40px 0;
  }
}

.btn-busy,
.btn.btn-busy,
.btn-sm.btn-busy {
  position: relative;
  pointer-events: none;
  opacity: 0.9;
}

.btn-busy::before {
  content: "";
  display: inline-block;
  width: 14px;
  height: 14px;
  margin-right: 8px;
  border: 2px solid rgba(255, 255, 255, 0.4);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.9s linear infinite;
  vertical-align: -2px;
}

@keyframes slideIn {
  from {
    opacity: 0;
    transform: translateY(-6px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.modal[hidden] {
  display: none;
}

.modal {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  background: rgba(0, 0, 0, 0.4);
  z-index: 50;
}

.modal .panel {
  width: min(800px, 92vw);
  background: var(--panel);
  border: 1px solid #2a3144;
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0, 0, 0, 0.4);
  overflow: hidden;
}

/* Panel variants moved from inline styles in index.html */
.panel--narrow { max-width: 520px; width: 96%; }
.panel--wide { max-width: 900px; width: 90%; }
.panel--image { max-width: min(920px, 96vw); }
.panel-header--spaced { display:flex; align-items:center; justify-content:space-between; gap:12px; }
.panel-header--spaced-lg { display:flex; align-items:center; justify-content:space-between; gap:16px; }
.panel-body--scroll { max-height: 60vh; overflow: auto; }
.panel-body--tall { max-height: 70vh; overflow: auto; }
.hint-sm--muted { opacity: .7; margin-bottom: 8px; }
.performer-import-list { display:grid; grid-template-columns: repeat(auto-fill, minmax(140px,1fr)); gap:8px; }
.panel-footer--actions { display:flex; justify-content:flex-end; gap:8px; margin-top:8px; align-items:center; }
.file-selection--compact { margin-bottom:12px; }
.selection-option--no-margin { margin:0; }
.hint-sm--small-top { margin-top:6px; }
.autotag-table { margin-top:8px; }
.autotag-table thead th:first-child { width:55%; }

/* Modal header and content spacing helpers */
.modal-content--wide { max-width: 720px; }
.modal-header--spaced { display:flex; align-items:center; justify-content:space-between; gap:12px; padding: 12px 14px; background: #161b27; border-bottom: 1px solid #2a3144; }
.m-0 { margin: 0; }

/* Error modal pre formatting */
.error-pre { white-space: pre-wrap; background: #111; color: #f88; padding: 12px; border-radius: 6px; max-height: 50vh; overflow: auto; }

.markers-header--spaced { display:flex; align-items:center; gap:8px; margin-bottom:6px; }
.label-inline { display:inline-flex; align-items:center; gap:6px; }

/* Thumb placeholder is hidden by default; JS toggles display */
.thumb-placeholder { display: none; width: 100%; height: 100%; }

.mt-4 { margin-top: 4px; }

.modal header {
  position: static;
  padding: 12px 14px;
  background: #161b27;
  border-bottom: 1px solid #2a3144;
}

.crumbs {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
  font-size: 12px;
  color: var(--muted);
}

.crumbs .seg {
  cursor: pointer;
  color: var(--text);
}

.crumbs .seg:hover {
  text-decoration: underline;
}

.modal .body {
  padding: 12px 14px;
  max-height: min(60vh, 520px);
  overflow: auto;
}

.dirlist {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 8px;
}

.dir {
  display: flex;
  align-items: center;
  gap: 10px;
  background: #1b2130;
  border: 1px solid #2a3144;
  border-radius: 8px;
  padding: 10px;
  cursor: pointer;
}

.dir:hover {
  background: #20283a;
}

.dir .icon {
  width: 20px;
  height: 16px;
  background: #6b7aa6;
  border-radius: 2px;
  position: relative;
}

.dir .icon::after {
  content: "";
  position: absolute;
  left: 0;
  top: -4px;
  width: 12px;
  height: 6px;
  background: #6b7aa6;
  border-top-left-radius: 2px;
  border-top-right-radius: 2px;
}

.modal .actions {
  display: flex;
  justify-content: flex-end;
  gap: 8px;
  padding: 12px 14px;
  border-top: 1px solid #2a3144;
}

.dir.muted {
  opacity: 0.8;
}

/* Grid controls - Modern card-based styling to match tasks */
.controls-panel {
  background: var(--card);
  border: 1px solid #2a3144;
  border-radius: 12px;
  margin: 0 16px 24px 16px;
  padding: 20px 24px;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
}

.controls-row {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 20px;
  flex-wrap: wrap;
}

.pagination-group {
  display: flex;
  align-items: center;
  gap: 16px;
  margin-left: auto;
}

.control-group {
  display: flex;
  align-items: center;
  gap: 8px;
}

.control-input {
  background: var(--bg);
  color: var(--text);
  border: 1px solid #2a3144;
  border-radius: 8px;
  padding: 10px 14px;
  font-size: 14px;
  outline: none;
  height: 40px;
  transition: all 0.2s ease;
}

.control-input:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(79, 140, 255, 0.2);
}

.select {
  position: relative;
  display: inline-flex;
  align-items: center;
}

.select .chevron {
  position: absolute;
  right: 12px;
  pointer-events: none;
  color: #9aa4bd;
}

.control-select {
  background: var(--bg);
  color: var(--text);
  border: 1px solid #2a3144;
  border-radius: 8px;
  padding: 10px 36px 10px 14px;
  /* leave room for chevron */
  font-size: 14px;
  outline: none;
  height: 40px;
  transition: all 0.2s ease;
  appearance: none;
  -webkit-appearance: none;
  -moz-appearance: none;
}

.control-select:focus {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(79, 140, 255, 0.2);
}

.control-select:hover {
  border-color: #3a435c;
}

.control-select:disabled {
  opacity: 0.6;
  cursor: not-allowed;
}

/* Make options readable in dark themes where UA styles may differ */
@media (prefers-color-scheme: dark) {
  .control-select option {
    background-color: #0e1220;
    color: #dfe6ff;
  }
}

.control-slider {
  background: var(--bg);
  outline: none;
  cursor: pointer;
  height: 6px;
  border-radius: 3px;
  border: 1px solid #2a3144;
  transition: all 0.2s ease;
  appearance: none;
  -webkit-appearance: none;
}

.control-slider::-webkit-slider-thumb {
  appearance: none;
  -webkit-appearance: none;
  height: 18px;
  width: 18px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.control-slider::-moz-range-thumb {
  height: 18px;
  width: 18px;
  background: var(--accent);
  border-radius: 50%;
  cursor: pointer;
  border: 2px solid white;
  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
}

.control-slider:hover {
  border-color: var(--accent);
}

.order-btn {
  min-width: 40px;
  height: 40px;
  font-size: 16px;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-left: 4px;
  border-radius: 8px;
  border: 1px solid #2a3144;
  background: var(--bg);
  color: var(--text);
  transition: all 0.2s ease;
  cursor: pointer;
}

.order-btn:hover {
  border-color: var(--accent);
  background: var(--accent);
  color: white;
}

.btn-sm {
  background: var(--bg);
  color: var(--text);
  border: 1px solid #2a3144;
  border-radius: 8px;
  padding: 10px 16px;
  font-size: 14px;
  cursor: pointer;
  font-weight: 500;
  height: 40px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-sm:hover {
  background: var(--card);
  border-color: var(--accent);
  box-shadow: 0 2px 4px rgba(79, 140, 255, 0.2);
}

.btn-sm.active {
  background: var(--accent);
  border-color: var(--accent);
  color: white;
}

.pagination {
  display: flex;
  align-items: center;
  gap: 12px;
}

.page-info {
  font-size: 14px;
  color: var(--muted);
  font-weight: 500;
  min-width: 80px;
  text-align: center;
}

/* Selection bar */
.selection-bar {
  position: fixed;
  bottom: 20px;
  left: 50%;
  transform: translateX(-50%);
  background: var(--accent);
  color: white;
  padding: 12px 20px;
  display: flex;
  align-items: center;
  gap: 12px;
  border-radius: 8px;
  box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
  z-index: 100;
}

.selection-bar[hidden] {
  display: none;
}

.selection-count {
  font-weight: 600;
}

/* Card selection overlay */
.card {
  position: relative;
  user-select: none;
  -webkit-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
}

.card.selection-mode {
  cursor: pointer;
}

.card-checkbox {
  position: absolute;
  top: 10px;
  left: 10px;
  width: 24px;
  height: 24px;
  background: rgba(0, 0, 0, 0.8);
  border: 2px solid white;
  border-radius: 6px;
  cursor: pointer;
  z-index: 10;
  opacity: 0;
  transition: opacity 0.2s ease;
}

.card:hover .card-checkbox,
.card-checkbox.checked {
  opacity: 1;
}

.card-checkbox.checked {
  background: var(--accent);
}

.card-checkbox.checked::after {
  content: "✓";
  color: white;
  font-size: 14px;
  font-weight: bold;
  position: absolute;
  top: 2px;
  left: 5px;
}

/* Quality badge (resolution) — Stash-like overlay styling */
.quality-badge {
  position: absolute;
  top: 8px;
  right: 8px;
  z-index: 9;
  display: none;
  /* shown when JS sets display inline */
  padding: 2px 6px;
  line-height: 1;
  border-radius: 4px;
  font-size: 12px;
  font-weight: 700;
  letter-spacing: 0.2px;
  color: #ffffff;
  background: rgba(0, 0, 0, 0.75);
  border: 1px solid rgba(255, 255, 255, 0.25);
  box-shadow: 0 1px 2px rgba(0, 0, 0, 0.35);
  text-shadow: 0 1px 0 rgba(0, 0, 0, 0.45);
}

/* Previously inline widths */
#searchInput {
  width: 280px;
}

#sortSelect {
  width: 120px;
}

#densitySlider {
  width: 200px;
}

/* Initial hidden elements */
#spinner,
#status {
  display: none;
}

/* Tab System */
.tab-nav {
  display: flex;
  margin-top: 8px;
}

.tab-button {
  background: transparent;
  border: none;
  color: var(--muted);
  font-size: 16px;
  font-weight: 600;
  padding: 12px 24px;
  cursor: pointer;
  position: relative;
  transition: all 0.2s ease;
  border-bottom: 3px solid transparent;
}

.tab-button:hover {
  color: var(--text);
  background: rgba(255, 255, 255, 0.05);
}

.tab-button.active {
  color: var(--accent);
  border-bottom-color: var(--accent);
}

.tab-button:focus {
  outline: 2px solid var(--accent);
  outline-offset: -2px;
}

.tab-panels {
  flex: 1;
  display: flex;
  flex-direction: column;
  /* margin-top removed so active panel can occupy full height */
}

.tab-panel {
  flex: 1;
  display: flex;
  flex-direction: column;
}

/* Give non-player panels internal breathing room since main padding was removed */
.tab-panel:not(#player-panel) {
  padding: 24px 0 24px;
}

.tab-panel[hidden] {
  display: none !important;
}

.tab-panel:not(.active) {
  display: none;
}

.tab-content {
  padding: 24px;
  flex: 1;
}

.tab-content h2 {
  margin: 0 0 16px 0;
  font-size: 24px;
  font-weight: 600;
}

.tab-content p {
  color: var(--muted);
  font-size: 16px;
  line-height: 1.5;
}

/* Tasks Interface - Professional Design */
.tasks-container {
  padding: 20px;
  display: flex;
  flex-direction: column;
  gap: 20px;
}

.task-section {
  background: var(--card);
  border-radius: 12px;
  padding: 20px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  box-shadow: 0 4px 16px rgba(0, 0, 0, 0.1);
  flex-shrink: 0;
}

.task-section:last-child {
  flex: 1;
  overflow: hidden;
  display: flex;
  flex-direction: column;
}

.section-header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: 16px;
  padding-bottom: 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  flex-shrink: 0;
}

/* Ensure top-right queue monitor buttons are in one horizontal line */
.section-header .section-actions {
  display: flex;
  align-items: center;
  gap: 8px;
  margin-left: auto;
  flex-wrap: nowrap;
}

.section-header h2 {
  margin: 0;
  font-size: 18px;
  font-weight: 600;
  color: var(--text);
  letter-spacing: -0.025em;
}

/* Job table layout stability */
.job-table-container {
  overflow: auto;
}

.job-table {
  width: 100%;
  border-collapse: collapse;
  table-layout: fixed;
  /* Prevent column width thrash */
}

.job-table th,
.job-table td {
  padding: 8px 10px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.08);
  vertical-align: middle;
}

.job-table thead th {
  color: var(--muted);
  font-weight: 600;
}

.job-table tbody tr:hover {
  background: rgba(255, 255, 255, 0.04);
}

/* Column widths */
.job-table th:nth-child(1),
.job-table td:nth-child(1) {
  width: 96px;
}

.job-table th:nth-child(2),
.job-table td:nth-child(2) {
  width: 140px;
}

.job-table th:nth-child(3),
.job-table td:nth-child(3) {
  width: 30%;
}

.job-table th:nth-child(4),
.job-table td:nth-child(4) {
  width: 120px;
}

.job-table th:nth-child(5),
.job-table td:nth-child(5) {
  width: 32%;
}

.job-table th:nth-child(6),
.job-table td:nth-child(6) {
  width: 120px;
}

/* Job table cells & truncation */
.job-table .cell-file {
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

.job-table .cell-status {
  text-transform: capitalize;
}

.job-table .cell-progress .cell-sub {
  display: flex;
  justify-content: space-between;
  gap: 8px;
  margin-top: 4px;
  color: var(--muted);
  font-size: 12px;
}

.job-table .cell-progress .fname {
  max-width: 240px;
  overflow: hidden;
  text-overflow: ellipsis;
  white-space: nowrap;
}

/* Stat card active state */
.job-stats {
  display: flex;
  gap: 10px;
  margin-bottom: 10px;
}

.job-stats .stat-card {
  cursor: pointer;
  user-select: none;
  padding: 10px 12px;
  background: rgba(255, 255, 255, 0.04);
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 8px;
  display: flex;
  align-items: center;
  gap: 8px;
}

.job-stats .stat-card.active {
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(79, 140, 255, 0.2) inset;
}

.btn-icon {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  color: var(--muted);
  cursor: pointer;
  padding: 10px;
  border-radius: 8px;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-icon:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text);
  border-color: var(--accent);
}

/* File Selection */
.file-selection {
  margin-bottom: 16px;
  padding: 12px 16px;
  background: rgba(255, 255, 255, 0.02);
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.08);
  flex-shrink: 0;
}

.selection-options {
  display: flex;
  gap: 24px;
  flex-wrap: wrap;
}

/* Ensure the Generate All button floats right in the selection options row */
#generateAllBtn {
  margin-left: auto;
}

.selection-option {
  display: flex;
  align-items: center;
  gap: 8px;
  cursor: pointer;
  padding: 8px 12px;
  border-radius: 6px;
  transition: background 0.2s ease;
  font-size: 14px;
  color: var(--text);
  font-weight: 500;
}

.selection-option:hover {
  background: rgba(255, 255, 255, 0.05);
}

.selection-option input[type="radio"] {
  margin: 0;
  accent-color: var(--accent);
  transform: scale(1.1);
}

/* Artifact Grid - Clean Layout */
.artifact-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
  gap: 16px;
  flex: 1;
}

.artifact-card {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.01) 100%);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 10px;
  padding: 16px;
  position: relative;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
  height: fit-content;
  /* Establish baseline stacking; will be raised when menu opens */
  z-index: 0;
}

.artifact-card .btn-options {
  position: absolute;
  top: 10px;
  right: 10px;
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.4);
}

.artifact-card .artifact-actions .btn-options {
  /* prevent layout reservation */
  position: absolute;
}

.artifact-card-uniform {
  display: flex;
  flex-direction: column;
  min-height: 180px;
}

.artifact-card-uniform .artifact-header {
  flex: 1 1 auto;
}


.artifact-card:hover {
  border-color: var(--accent);
  box-shadow: 0 8px 24px rgba(79, 140, 255, 0.15);
  transform: translateY(-2px);
}

/* When an options menu is open, ensure the card sits above neighbors */
.artifact-card.menu-open {
  z-index: 2000;
  overflow: visible;
  /* be explicit to avoid any accidental clipping */
}

.artifact-header {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-bottom: 12px;
}

.artifact-info {
  flex: 1;
}

#player-panel {
  flex: 1 1 auto;
  display: flex;
  flex-direction: column;
  min-height: 0;
  padding: 20px;
}
.player-split {
  display: flex;
  flex: 1 1 auto; /* fill remaining space */
  width: 100%;
  gap: 8px;
  align-items: stretch;
  box-sizing: border-box;
  min-height: 0;
  /* no explicit height: rely on flex chain (body > main > tab-panels > #player-panel > .player-split) */
}

/* Keep the player area at a stable height so collapsing/expanding the
   sidebar doesn't change the player's vertical size. This uses a viewport
   relative minimum but allows the layout to shrink on small screens. */
.player-split { min-height: 60vh; }

.player-split {
  /* Allow overflow so child focus/hover outlines (box-shadow) are visible.
     Internal scrolling is still confined to the sidebar (.player-sidebar).
     This prevents the sidebar-toggle's focus ring from being clipped. */
  overflow: visible;
}
.player-split .player-main {
  overflow: hidden; /* main area should not create vertical scroll */
}
.player-split .player-sidebar {
  overflow-y: auto; /* sidebar can scroll internally if content is long */
  -webkit-overflow-scrolling: touch;
}
.player-split .player-sidebar,
.player-split .player-main {
  border: 1px solid var(--border-color, #333);
  border-radius: 4px;
  padding: 8px; /* reduced padding for more compact height */
  box-sizing: border-box;
  background: var(--panel-bg, rgba(0,0,0,0.15));
  min-height: 0;
  max-height: 100%;
}
.player-split .player-sidebar {
  flex: 0 0 var(--player-sidebar-w);
  width: var(--player-sidebar-w);
  max-width: var(--player-sidebar-w);
}
.player-split .player-main {
  flex: 1 1 auto; /* fully fluid */
  min-width: 0;  /* prevent overflow due to long content */
}

.player-split .player-main { overflow: hidden; }
.player-split .player-sidebar { overflow-y: auto; }

/* Make the main column a vertical flex container so the video can fill
  the available height while controls/overlays sit above/below. */
.player-split .player-main { display: flex; flex-direction: column; }

/* Ensure the video fills the main area vertically and does not grow when
  the sidebar width changes. Using height:100% keeps height stable while
  object-fit handles letterboxing inside that frame. */
.player-main .player-video { height: 100%; max-height: 100%; flex: 1 1 auto; }

@media (max-width: 900px) {
  .player-split .player-sidebar {
    flex: 0 0 220px;
    width: 220px;
    max-width: 220px;
  }
}

@media (max-width: 640px) {
  .player-split { flex-direction: column; }
  .player-split .player-sidebar,
  .player-split .player-main {
    width: 100%;
    max-width: none;
    flex: 0 0 auto;
  }
  .player-split .player-main { flex: 1 1 auto; }
}

/* Collapse rules: hide the sidebar element entirely so the main area expands */
.has-sidebar-collapsed .player-split { gap: 6px; }

/* Animate collapse by shrinking max-width and flex-basis instead of using display:none */
.player-split .player-sidebar { transition: max-width 280ms ease, flex-basis 280ms ease, padding 220ms ease; overflow: hidden; }
.has-sidebar-collapsed .player-split .player-sidebar { max-width: 0 !important; flex: 0 0 0 !important; padding-left: 0 !important; padding-right: 0 !important; }

/* Rotate the caret icon when collapsed (points right when collapsed) */
.has-sidebar-collapsed .sidebar-toggle__icon { transform: rotate(180deg); }

/* Full-height opt-in modifier: add class to #player-panel if needed */
/* Full-height modifier no longer required; keeping hook in case future conditional behavior needed */
/* #player-panel.is-fullheight .player-split { } */
.svg-sprite {
  position: absolute;
  width: 0;
  height: 0;
  overflow: hidden;
}

/* Hide the overlay bar when the title is empty so no empty bar remains visible */
/* Prefer CSS :has where supported; JS observer below ensures compatibility */
.player-overlay-bar:has(.player-title:empty) {
  display: none !important;
}

.artifact-info h3 {
  margin: 0 0 8px 0;
  font-size: 15px;
  font-weight: 600;
  color: var(--text);
  letter-spacing: -0.025em;
}

.coverage-display {
  display: flex;
  flex-direction: column;
  gap: 8px;
  margin-bottom: 16px;
}

.coverage-text {
  font-size: 18px;
  font-weight: 700;
  color: var(--accent);
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
  text-align: center;
}

.coverage-bar-mini {
  width: 100%;
  height: 8px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 4px;
  overflow: hidden;
  position: relative;
}

.coverage-fill-mini {
  height: 100%;
  background: linear-gradient(90deg, var(--accent) 0%, #22c55e 100%);
  transition: width 0.4s cubic-bezier(0.4, 0, 0.2, 1);
  width: 0%;
  border-radius: 4px;
}

.artifact-actions {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: 12px;
}

.btn-generate {
  padding: 8px 12px;
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 6px;
  background: rgba(255, 255, 255, 0.05);
  color: var(--text);
  font-size: 11px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  white-space: nowrap;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

/* Unified primary artifact action button; contextual color set via JS (btn-danger for destructive) */
.btn-generate {
  background: var(--accent);
  color: #fff;
  border-color: var(--accent);
  font-size: 11px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.btn-generate:hover {
  background: #3b82ff;
  box-shadow: 0 4px 12px rgba(79, 140, 255, 0.3);
  transform: translateY(-1px);
}

/* Variant: generate-missing (slightly amber to differentiate) */
.btn-generate[data-state="missing"] {
  background: #d97706;
  /* amber-600 */
  border-color: #d97706;
}

.btn-generate[data-state="missing"]:hover {
  background: #f59e0b;
  /* amber-500 */
  box-shadow: 0 4px 12px rgba(217, 119, 6, 0.35);
}

/* Variant: clear (still relies on btn-danger already defined) */
.btn-generate.btn-danger {
  background: linear-gradient(135deg, #dc2626, #ef4444);
  border-color: #ef4444;
}

.btn-generate.btn-danger:hover {
  filter: brightness(1.05);
}

.btn-options {
  background: rgba(255, 255, 255, 0.05);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 6px;
  padding: 6px;
  cursor: pointer;
  color: var(--muted);
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.btn-options:hover {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text);
  border-color: var(--accent);
}

/* Options Tooltip - Enhanced */
.options-tooltip {
  position: absolute;
  top: 48px;
  /* below top bar & button */
  right: 10px;
  z-index: 1000;
  background: var(--card);
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 12px;
  padding: 16px;
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.4);
  min-width: 240px;
  backdrop-filter: blur(20px);
}

.options-tooltip::before {
  /* reposition arrow to point at button */
  content: '';
  position: absolute;
  top: -6px;
  right: 22px;
  width: 0;
  height: 0;
  border-left: 6px solid transparent;
  border-right: 6px solid transparent;
  border-bottom: 6px solid var(--card);
}

.options-tooltip label {
  display: block;
  margin-bottom: 12px;
  font-size: 13px;
  color: var(--text);
  font-weight: 500;
}

.options-tooltip input,
.options-tooltip select {
  width: 100%;
  padding: 8px 12px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  border-radius: 6px;
  background: rgba(255, 255, 255, 0.05);
  color: var(--text);
  font-size: 12px;
  margin-top: 4px;
  transition: all 0.2s ease;
}

.options-tooltip input:focus,
.options-tooltip select:focus {
  outline: none;
  border-color: var(--accent);
  box-shadow: 0 0 0 2px rgba(79, 140, 255, 0.2);
  background: rgba(255, 255, 255, 0.08);
}

/* Job Monitor - Enhanced */
.job-stats {
  display: grid;
  grid-template-columns: repeat(4, 1fr);
  gap: 12px;
  margin-bottom: 16px;
}

.stat-card {
  background: linear-gradient(135deg, rgba(255, 255, 255, 0.05) 0%, rgba(255, 255, 255, 0.02) 100%);
  border-radius: 8px;
  padding: 12px;
  display: flex;
  flex-direction: column;
  align-items: center;
  text-align: center;
  border: 1px solid rgba(255, 255, 255, 0.1);
  transition: all 0.2s ease;
}

.stat-card:hover {
  border-color: var(--accent);
  background: linear-gradient(135deg, rgba(79, 140, 255, 0.1) 0%, rgba(79, 140, 255, 0.05) 100%);
}

.stat-label {
  font-size: 11px;
  color: var(--muted);
  margin-bottom: 4px;
  text-transform: uppercase;
  letter-spacing: 0.5px;
  font-weight: 600;
}

.stat-value {
  font-size: 20px;
  font-weight: 700;
  color: var(--accent);
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
}

.job-table-container {
  background: rgba(255, 255, 255, 0.02);
  border-radius: 8px;
  border: 1px solid rgba(255, 255, 255, 0.1);
  /* Allow natural height growth; only scroll if container ancestor constrains height */
  overflow: auto;
  scrollbar-gutter: stable both-edges;
  overscroll-behavior: contain;
  position: relative;
}

/* Hide scrollbar but preserve scrolling */
.job-table-container::-webkit-scrollbar { width: 0; height: 0; }
.job-table-container { scrollbar-width: none; }
.job-table-container { -ms-overflow-style: none; }


.resize-handle {
  position: sticky;
  bottom: 0;
  left: 0;
  right: 0;
  height: 10px;
  cursor: ns-resize;
  background: linear-gradient(180deg, transparent, rgba(255, 255, 255, 0.06));
}

body.resizing-job-table {
  cursor: ns-resize !important;
  user-select: none;
}

/* WebKit overlay scrollbar styling */
.job-table-container::-webkit-scrollbar {
  width: 10px;
  height: 10px;
}

.job-table-container::-webkit-scrollbar-track {
  background: transparent;
}

.job-table-container::-webkit-scrollbar-thumb {
  background-color: rgba(255, 255, 255, 0.18);
  border-radius: 10px;
  border: 2px solid rgba(0, 0, 0, 0);
  background-clip: padding-box;
}

.job-table-container::-webkit-scrollbar-thumb:hover {
  background-color: rgba(255, 255, 255, 0.28);
}

.job-table {
  width: 100%;
  border-collapse: collapse;
  font-size: 12px;
}

.job-table th {
  background: rgba(255, 255, 255, 0.05);
  padding: 8px 12px;
  text-align: left;
  font-size: 11px;
  font-weight: 600;
  color: var(--text);
  border-bottom: 1px solid rgba(255, 255, 255, 0.1);
  position: sticky;
  top: 0;
  z-index: 1;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.job-table td {
  padding: 8px 12px;
  border-bottom: 1px solid rgba(255, 255, 255, 0.05);
  font-size: 11px;
  color: var(--text);
}

.job-table tbody tr:hover {
  background: rgba(255, 255, 255, 0.03);
}

.job-status {
  padding: 4px 8px;
  border-radius: 16px;
  font-size: 10px;
  font-weight: 700;
  text-transform: uppercase;
  letter-spacing: 0.5px;
}

.job-status.running {
  background: rgba(79, 140, 255, 0.2);
  color: var(--accent);
}

.job-status.completed {
  background: rgba(34, 197, 94, 0.2);
  color: #22c55e;
}

.job-status.failed {
  background: rgba(239, 68, 68, 0.2);
  color: #ef4444;
}

.job-status.queued {
  background: rgba(245, 158, 11, 0.2);
  color: #f59e0b;
}

.job-progress {
  width: 100px;
  height: 6px;
  background: rgba(255, 255, 255, 0.1);
  border-radius: 3px;
  overflow: hidden;
}

.job-progress-fill {
  height: 100%;
  background: linear-gradient(90deg, var(--accent), #22c55e);
  transition: width 0.3s ease;
  border-radius: 3px;
}

/* Responsive Design */
@media (max-width: 768px) {
  .controls-panel {
    margin: 0 8px 16px 8px;
    padding: 12px 16px;
  }

  .control-group {
    gap: 6px;
  }

  .tasks-container {
    padding: 8px;
    gap: 12px;
  }

  .task-section {
    padding: 12px;
  }

  .section-header {
    margin-bottom: 8px;
  }

  .job-stats {
    grid-template-columns: 1fr;
    gap: 8px;
  }

  .artifact-grid {
    grid-template-columns: 1fr;
    gap: 12px;
  }

  .artifact-card {
    min-width: unset;
  }

  .artifact-actions {
    flex-direction: column;
    gap: 8px;
  }

  .coverage-text {
    font-size: 16px;
  }

  /* Removed mobile max-height constraint for job table container */

  .job-table {
    font-size: 11px;
  }

  .job-table th,
  .job-table td {
    padding: 6px 8px;
  }
}

@media (max-width: 480px) {
  .tasks-container {
    padding: 4px;
    gap: 8px;
  }

  .task-section {
    padding: 8px;
  }

  .artifact-grid {
    gap: 8px;
  }

  .artifact-header {
    gap: 8px;
  }

  .coverage-text {
    font-size: 14px;
  }

  .job-stats {
    gap: 6px;
  }

  .stat-card {
    padding: 8px;
  }

  .stat-value {
    font-size: 18px;
  }

  .stat-label {
    font-size: 10px;
  }
}

/* Directory card template styles */
.dir-thumb {
  display: flex;
  align-items: center;
  justify-content: center;
  background: #121723;
  color: #aab2c7;
  font-weight: 600;
  letter-spacing: .2px;
}

.dir-thumb-inner {
  display: flex;
  align-items: center;
  gap: 10px;
}

.dir-icon {
  display: inline-block;
  width: 20px;
  height: 16px;
  background: #6b7aa6;
  border-radius: 2px;
  position: relative;
}

.dir .icon.dim {
  opacity: .4;
}

/* Animations */
@keyframes fadeIn {
  from {
    opacity: 0;
    transform: translateY(10px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes slideInRight {
  from {
    opacity: 0;
    transform: translateX(100%);
  }

  to {
    opacity: 1;
    transform: translateX(0);
  }
}

/* (Duplicate spin keyframes removed; single definition earlier) */

/* Orphaned Artifacts Section */
.orphan-card {
  background: linear-gradient(135deg, rgba(255, 71, 87, 0.03) 0%, rgba(255, 71, 87, 0.01) 100%);
  border: 1px solid rgba(255, 71, 87, 0.2);
  border-radius: 10px;
  padding: 20px;
  transition: all 0.3s ease;
  backdrop-filter: blur(10px);
}

.orphan-card:hover {
  border-color: rgba(255, 71, 87, 0.4);
  box-shadow: 0 8px 24px rgba(255, 71, 87, 0.15);
  transform: translateY(-2px);
}

.orphan-header {
  display: flex;
  justify-content: space-between;
  align-items: flex-start;
  gap: 16px;
}

.orphan-info h3 {
  margin: 0 0 8px 0;
  font-size: 16px;
  font-weight: 600;
  color: var(--text);
}

.orphan-stats {
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.orphan-count {
  font-size: 24px;
  font-weight: 700;
  color: #ff4757;
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
}

.orphan-label {
  font-size: 13px;
  color: var(--muted);
}

.orphan-actions {
  display: flex;
  gap: 8px;
  flex-shrink: 0;
}

.btn-cleanup {
  background: linear-gradient(135deg, #ff4757 0%, #ff3742 100%);
  color: white;
  border: none;
  border-radius: 8px;
  padding: 10px 16px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 80px;
}

.btn-cleanup:hover:not(:disabled) {
  background: linear-gradient(135deg, #ff3742 0%, #ff2533 100%);
  transform: translateY(-1px);
  box-shadow: 0 4px 12px rgba(255, 71, 87, 0.3);
}

.btn-cleanup:disabled {
  background: rgba(255, 71, 87, 0.3);
  cursor: not-allowed;
  opacity: 0.6;
}

.btn-preview {
  background: rgba(255, 255, 255, 0.1);
  color: var(--text);
  border: 1px solid rgba(255, 255, 255, 0.2);
  border-radius: 8px;
  padding: 10px 16px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  transition: all 0.2s ease;
  min-width: 80px;
}

.btn-preview:hover:not(:disabled) {
  background: rgba(255, 255, 255, 0.15);
  border-color: rgba(255, 255, 255, 0.3);
  transform: translateY(-1px);
}

.btn-preview:disabled {
  background: rgba(255, 255, 255, 0.05);
  cursor: not-allowed;
  opacity: 0.6;
}

.orphan-details {
  margin-top: 16px;
  padding-top: 16px;
  border-top: 1px solid rgba(255, 255, 255, 0.1);
}

.orphan-list {
  max-height: 200px;
  overflow-y: auto;
  background: rgba(0, 0, 0, 0.2);
  border-radius: 6px;
  padding: 12px;
}

.orphan-file {
  display: block;
  font-size: 12px;
  color: var(--muted);
  font-family: 'SF Mono', Monaco, 'Cascadia Code', monospace;
  margin-bottom: 4px;
  padding: 2px 4px;
  border-radius: 3px;
  transition: background-color 0.2s ease;
}

.orphan-file:hover {
  background: rgba(255, 255, 255, 0.05);
  color: var(--text);
}

/* Sidebar Accordion */
.accordion .acc-header {
  width: 100%;
  text-align: left;
  background: #141c2b;
  color: #cfd6e4;
  border: 1px solid rgba(255, 255, 255, 0.08);
  border-radius: 6px;
  padding: 6px 10px;
  font-size: 13px;
  font-weight: 600;
  cursor: pointer;
  position: relative;
  display: flex;
  align-items: center;
  gap: 6px;
}

.accordion .acc-panel { padding:6px 4px 4px; transition: height .24s ease, padding .24s ease; }
.accordion .acc-panel.animating { overflow:hidden; }

/* Slide content inside panel: translate + fade for a smooth slide-down/up feel.
   We animate children so we don't need JS measurements. The panel itself still
   animates max-height and opacity for an overall slide effect; children then
   translate/fade with a small delay when opening. */
.accordion .acc-panel {
  overflow: hidden; /* ensure content doesn't escape during transition */
}
.accordion .acc-panel > * {
  transform: translateY(-8px);
  opacity: 0;
  transition: transform 220ms cubic-bezier(.2,.9,.2,1), opacity 180ms ease;
  transition-delay: 0ms;
}
.accordion .acc-panel.open > * {
  transform: translateY(0);
  opacity: 1;
  transition-delay: 60ms; /* slight delay so height expands first */
}

/* Respect reduced motion preferences */
@media (prefers-reduced-motion: reduce) {
  .accordion .acc-panel,
  .accordion .acc-panel > *,
  .accordion .acc-header .acc-header__icon {
    transition: none !important;
  }
}


.accordion .acc-item+.acc-item {
  margin-top: 8px; /* increased spacing to avoid visual overlap */
}

/* Ensure first accordion item has top spacing to avoid overlap with preceding elements */
.accordion .acc-item:first-child { margin-top: 6px; }

@keyframes accFade {
  from {
    opacity: 0;
    transform: translateY(-2px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

/* === Simplified Player Overhaul (experimental) === */
.player-shell {
  display: flex;
  flex-direction: column;
  gap: 18px;
  padding: 8px 4px 32px;
}

.player-shell.no-sidebar .player-main {
  width: 100%;
}

.player-main {
  display: flex;
  flex-direction: column;
  gap: 14px;
  min-width: 0;
}

/* Reset previous mixed grid/flex definitions; enforce single-line flex bar */
.player-bar-simple {
  display: flex;
  align-items: center;
  gap: 6px;
  flex-wrap: nowrap;
  overflow: hidden;
  background: #101724;
  border: 1px solid #263144;
  padding: 6px 8px;
  border-radius: 10px;
  box-shadow: 0 4px 18px -6px rgba(0, 0, 0, 0.5);
  min-width: 0;
}

.player-bar-simple>* {
  flex: 0 0 auto;
}

.player-bar-simple .bar-timeline-wrap {
  flex: 1 1 auto;
  min-width: 0;
}

.util-btn {
  background: #182535;
}

.util-btn:hover {
  background: #1e3044;
}

/* No special sidebar responsive rules needed after removal */
@media (max-width: 640px) {
  .player-bar-simple {
    flex-wrap: wrap;
    row-gap: 6px;
  }

  .player-bar-simple .util-btn {
    order: 99;
  }
}

.player-simple {
  display: flex;
  flex-direction: column;
  gap: 14px;
  padding: 8px 4px 24px;
}

.player-header-simple {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 12px;
  padding: 4px 4px 0;
}

.player-header-simple h2 {
  font-size: 20px;
  font-weight: 600;
  margin: 0;
  letter-spacing: .4px;
}

.player-stage-simple {
  position: relative;
  background: #05070c;
  border: 2px solid #1c2735;
  border-radius: 16px;
  padding: 8px;
  box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.7);
  display: flex;
  justify-content: center;
  align-items: center;
  flex: 1 1 auto; /* allow stage to expand vertically */
  min-height: 0; /* enable child flex sizing */
}

.video-stage-simple::after {
  content: "";
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  height: 70px;
  pointer-events: none;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0));
  border-bottom-left-radius: inherit;
  border-bottom-right-radius: inherit;
}

.player-stage-simple .video-el {
  width: 100%;
  max-width: 100%;
  aspect-ratio: 16/9;
  background: #000;
  border-radius: 10px;
  display: block;
  height: calc(100vh - var(--header-h));
  max-height: calc(100vh - var(--header-h));
  object-fit: contain;
}

.player-bar-simple .time-display {
  font-variant-numeric: tabular-nums;
  display: flex;
  gap: 4px;
  align-items: center;
  font-size: 11px;
}

.player-bar-simple .sep {
  opacity: .45;
}

.bar-timeline-wrap {
  width: 100%;
  display: flex;
  align-items: center;
}

.timeline-flat {
  position: relative;
  height: 8px;
  background: #1d2835;
  border-radius: 4px;
  overflow: hidden;
  cursor: pointer;
  width: 100%;
}

.timeline-flat .timeline-heatmap,
.timeline-flat .timeline-heatmap-canvas,
.timeline-flat .timeline-progress,
.timeline-flat .timeline-markers {
  position: absolute;
  inset: 0;
}

.timeline-flat .timeline-progress {
  background: linear-gradient(90deg, #4f8cff, #2e5fa8);
  width: 0%;
  mix-blend-mode: normal;
  transition: width .1s linear;
}

.vol-slider {
  width: 110px;
}

.rate-select-inline {
  background: #162131;
  border: 1px solid #2a3a4e;
  padding: 2px 6px;
  border-radius: 6px;
  font-size: 12px;
}

.rate-select-inline:focus {
  outline: 2px solid var(--accent, #4f8cff);
  outline-offset: 2px;
}

/* Icon buttons */
.icon-btn {
  position: relative;
  width: 28px;
  height: 28px;
  padding: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  border: 1px solid #2a3144;
  background: #182230;
  border-radius: 8px;
  flex: 0 0 auto;
}

.icon-btn .icon {
  width: 16px;
  height: 16px;
  stroke-width: 2;
}

.icon-btn:hover {
  background: #203040;
}

.icon-btn:active {
  background: #15222f;
}

.icon-btn.util-btn {
  background: #1d2a38;
}

.icon-btn.util-btn:hover {
  background: #253547;
}

.icon-btn svg {
  stroke: none;
  fill: currentColor;
}

/* Medium icon sizing utility */
.icon-md { width: 20px; height: 20px; display: inline-block; }

/* Ensure svg inside .icon-md inherits currentColor */
.icon-md svg { width: 100%; height: 100%; fill: currentColor; }

@media (max-width: 900px) {
  .vol-slider {
    width: 80px;
  }
}

/* Scrubber overlay at bottom of video */
.video-stage-simple {
  position: relative;
}

.video-stage-simple .timeline-overlay-shell {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 0 10%;
  pointer-events: none;
  display: flex;
  flex-direction: column;
  gap: 4px;
}

.player-bar-overlay {
  pointer-events: auto;
  display: flex;
  align-items: center;
  gap: 6px;
  background: rgba(10, 14, 20, 0.72);
  backdrop-filter: blur(6px);
  border: 1px solid rgba(255, 255, 255, 0.12);
  border-radius: 8px;
  padding: 6px 10px;
}

.player-bar-overlay .spacer {
  flex: 1 1 auto;
}

.player-bar-overlay .time-display {
  font-variant-numeric: tabular-nums;
  font-size: 11px;
  opacity: .85;
}

.player-bar-overlay select {
  background: #162131;
  border: 1px solid #2a3a4e;
  padding: 2px 4px;
  border-radius: 6px;
  font-size: 11px;
}

.player-bar-overlay .vol-slider {
  width: 90px;
}

.player-bar-overlay .icon-btn {
  width: 26px;
  height: 26px;
}

.player-bar-overlay .icon-btn .icon {
  width: 14px;
  height: 14px;
}

.timeline-overlay-shell .timeline-flat {
  height: 6px;
  border-radius: 3px;
}

.timeline-overlay-shell .timeline-flat:hover {
  height: 8px;
}

.timeline-overlay-shell .timeline-wrapper {
  pointer-events: auto;
}

/* Info button active state */
#infoToggle.active {
  background: var(--accent, #4f8cff);
  color: #fff;
  box-shadow: 0 0 0 1px rgba(0, 0, 0, 0.4) inset;
}

/* Info Drawer */
.info-drawer {
  background: #0b1119;
  border: 1px solid #1e2b3b;
  border-radius: 14px;
  padding: 14px 16px 18px;
  animation: accFade .35s ease;
  box-shadow: 0 6px 28px -8px rgba(0, 0, 0, 0.55);
}

.drawer-inner {
  display: grid;
  gap: 24px;
  grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
}

.drawer-heading {
  font-size: 12px;
  font-weight: 600;
  text-transform: uppercase;
  letter-spacing: .8px;
  opacity: .7;
  margin: 0 0 6px;
}

.mini-meta {
  list-style: none;
  margin: 0;
  padding: 0;
  display: flex;
  flex-direction: column;
  gap: 4px;
  font-size: 12px;
}

.mini-meta li {
  display: flex;
  justify-content: space-between;
  gap: 8px;
  padding: 4px 6px;
  background: #121c29;
  border: 1px solid #1f2b3a;
  border-radius: 6px;
}

.mini-meta li span:first-child {
  opacity: .65;
}

.artifact-badges-flat {
  display: flex;
  flex-wrap: wrap;
  gap: 6px;
}

.artifact-badges-flat .badge-pill {
  font-size: 11px;
  padding: 4px 8px;
  border-radius: 20px;
  background: #142031;
  border: 1px solid #223246;
  cursor: pointer;
  line-height: 1.1;
  display: inline-flex;
  align-items: center;
  gap: 4px;
}

.artifact-badges-flat .badge-pill[data-present="1"] {
  background: #17324d;
  border-color: #24527a;
}

/* Loading state spinner for artifact badges */
@keyframes badge-spin { to { transform: rotate(360deg); } }
.artifact-badges-flat .badge-pill[data-loading="1"] {
  position: relative;
  opacity: .75;
  pointer-events: none; /* prevent double clicks */
}
.artifact-badges-flat .badge-pill[data-loading="1"] span[id$="-status"] {
  visibility: hidden; /* hide ✓ / ✗ while spinning */
}
.artifact-badges-flat .badge-pill[data-loading="1"]::after {
  content: "";
  position: absolute;
  right: 6px;
  width: 12px;
  height: 12px;
  border: 2px solid #4b6b8f;
  border-top-color: #ffffff;
  border-radius: 50%;
  animation: badge-spin .7s linear infinite;
  box-sizing: border-box;
}

.effects-panel-slim {
  display: flex;
  flex-direction: column;
  gap: 6px;
  font-size: 11px;
  background: #121c29;
  padding: 8px 10px 10px;
  border: 1px solid #1f2b3a;
  border-radius: 8px;
}

/* Add subtle bordered boxes for performers and tags chip groups inside the video sidebar */
.chips-group {
  border: 1px solid rgba(255,255,255,0.06);
  padding: 8px;
  border-radius: 8px;
  background: rgba(0,0,0,0.02);
}

.chips-group .chips-label { margin-bottom: 6px; display:block; font-weight:600; }

.effects-panel-slim label {
  display: flex;
  align-items: center;
  gap: 8px;
  justify-content: space-between;
}

.effects-panel-slim input[type=range] {
  flex: 1;
  appearance: none;
  height: 4px;
  background: #243246;
  border-radius: 4px;
}

.effects-panel-slim input[type=range]::-webkit-slider-thumb {
  appearance: none;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--accent, #4f8cff);
  border: 2px solid #0d121d;
}

/* Hide legacy complex layout elements if still present */
#playerLayout,
#playerSidebar,
.player-overlay,
.controls-overlay,
.timeline-overlay {
  display: none !important;
}

@media (max-width: 860px) {
  .player-bar-simple {
    grid-template-columns: auto auto 1fr auto auto auto auto auto auto;
    gap: 8px;
  }

  .vol-slider {
    width: 90px;
  }
}

@media (max-width: 600px) {
  .player-bar-simple {
    grid-template-columns: auto 1fr auto auto auto auto auto;
  }

  .rate-select-inline,
  #btnSetThumb,
  #btnAddMarker {
    display: none;
  }

  .vol-slider {
    width: 70px;
  }

  .drawer-inner {
    grid-template-columns: 1fr;
  }
}

/* -----------------------------
   Player Tab Modernized Styles
   (migrated from inline styles)
------------------------------*/
.player-layout {
  display: flex;
  gap: 14px;
  align-items: stretch;
  padding: 12px 0 8px;
  min-height: 60vh;
}

.player-container {
  display: flex;
  flex-direction: column;
  gap: 12px;
  flex: 1;
  min-width: 0;
}

.player-header {
  display: flex;
  align-items: center;
  gap: 12px;
  justify-content: flex-start;
  min-height: 32px;
}

.player-title {
  font-weight: 600;
  font-size: 18px;
  letter-spacing: .3px;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}

.player-video {
  position: relative;
  background: #000;
  border: 1px solid #1d2533;
  border-radius: 12px;
  overflow: hidden;
  box-shadow: 0 4px 26px -4px rgba(0, 0, 0, 0.55), 0 0 0 1px rgba(255, 255, 255, 0.04) inset;
  flex: 1 1 auto;
  width: 100%;
  max-height: 100%;
  height: auto;
  object-fit: contain;
}

/* Floating overlay title bar */
.player-overlay-bar {
  position: absolute;
  top: 8px;
  left: 50%;
  transform: translateX(-50%);
  background: linear-gradient(135deg, rgba(22,30,44,.72), rgba(15,22,32,.58));
  -webkit-backdrop-filter: blur(8px) saturate(140%);
  backdrop-filter: blur(8px) saturate(140%);
  padding: 8px 18px 9px;
  border-radius: 46px;
  font-size: 13px;
  line-height: 1.15;
  color: var(--text);
  letter-spacing: .4px;
  box-shadow: 0 4px 22px -8px rgba(0,0,0,.72), 0 0 0 1px rgba(255,255,255,0.09) inset, 0 1px 2px rgba(255,255,255,0.06) inset;
  display: flex;
  align-items: center;
  gap: 10px;
  opacity: 1;
  transition: opacity .4s ease, transform .4s ease;
  z-index: 20;
  pointer-events: none; /* non-interactive for now */
}
.player-overlay-bar.fading {
  opacity: 0;
  transform: translateX(-50%) translateY(-4px);
}

/* Suppress initial flash of empty overlay title bar */
.player-overlay-bar[data-empty="1"] {
  opacity: 0 !important;
  pointer-events: none !important;
  transition: none;
}

/* Overlay title text subtle styling */
#playerTitle.player-title {
  font-weight: 500;
  max-width: 48vw;
  text-shadow: 0 2px 4px rgba(0,0,0,.6);
  font-family: var(--font-stack, system-ui, sans-serif);
  letter-spacing: .35px;
}

/* Bottom floating scrubber */
.player-scrubber-bar {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  transform: none;
  width: 100%;
  padding: 14px 22px 18px;
  display: flex;
  flex-direction: column;
  gap: 8px;
  background: linear-gradient(to top, rgba(8,12,18,.78), rgba(10,16,24,.6) 60%, rgba(10,16,24,0));
  -webkit-backdrop-filter: blur(10px) saturate(150%);
  backdrop-filter: blur(10px) saturate(150%);
  border-radius: 0;
  font-size: 12px;
  color: var(--text-alt, #d7dde5);
  z-index: 22;
  opacity: 1;
  transition: opacity .45s ease, transform .45s ease;
  pointer-events: auto; /* interactive now */
}
.player-scrubber-bar.fading { opacity: 0; transform: translateY(8px); }

/* Scrubber inline action buttons (Add Marker / Set Thumbnail) */
.scrubber-actions-row .btn.btn-xs {
  background:#1a2735;
  border:1px solid #2b3d52;
  color:#d5e2f2;
  padding:4px 8px;
  font-size:11px;
  line-height:1.1;
  border-radius:4px;
  cursor:pointer;
}
.scrubber-actions-row .btn.btn-xs:hover { background:#223345; border-color:#38516b; }
.scrubber-actions-row { font-size:11px; }

/* Inline time + action buttons */
.scrubber-status-row {
  display:flex;
  align-items:center;
  gap:10px;
  margin-top:4px;
  font-size:11px;
}
.scrubber-status-row .scrubber-time { flex:0 0 auto; }
.scrubber-status-row .btn.btn-xs { flex:0 0 auto; }

/* File Info two-column list */
.file-info-grid { display:flex; flex-direction:column; gap:4px; font-size:12px; padding:4px 2px 2px; }
.file-info-grid .fi-row { display:grid; grid-template-columns: 124px 1fr; gap:0; align-items:stretch; min-height:22px; }
.file-info-grid .fi-label { font-weight:600; letter-spacing:.25px; color:#9fb4c9; text-align:right; padding:2px 8px 2px 8px; background:linear-gradient(to right, rgba(255,255,255,0.05), rgba(255,255,255,0)); border-right:1px solid rgba(255,255,255,0.08); display:flex; align-items:center; justify-content:flex-end; }
.file-info-grid .fi-row:nth-child(odd) .fi-label { background:linear-gradient(to right, rgba(255,255,255,0.06), rgba(255,255,255,0)); }
.file-info-grid .fi-value { color:#e1e8f0; font-variant-numeric: tabular-nums; }
.file-info-grid .fi-value.break { word-break: break-all; overflow-wrap:anywhere; }
.file-info-grid .fi-row:nth-child(odd) { background:rgba(255,255,255,0.018); }
.file-info-grid .fi-value { padding:2px 6px; display:flex; align-items:center; }
.file-info-grid .fi-value.break { word-break: break-all; overflow-wrap:anywhere; }
.file-info-grid .fi-row:hover { background:rgba(255,255,255,0.05); }
/* Inline rename state */
.file-info-grid .fi-value.renaming { opacity:.75; }
.fi-rename-input { font-size:12px; }
.fi-rename-input { width:100%; box-sizing:border-box; }
.fi-rename-input:focus { outline: none; box-shadow:0 0 0 2px rgba(79,140,255,.35); border-color: var(--accent); }

/* Video metadata chips (performers & tags) */
.video-meta-chips { margin-top:8px; display:flex; flex-direction:column; gap:10px; }
.video-meta-chips .chips-group { display:flex; flex-direction:column; gap:4px; }
.video-meta-chips .chips-label { font-size:11px; font-weight:600; text-transform:uppercase; letter-spacing:.75px; color:#9fb4c9; }
.video-meta-chips .chips-list { display:flex; flex-wrap:wrap; gap:6px; min-height:30px; padding:4px 0; }
.video-meta-chips .chip { background:#223042; border:1px solid #314355; color:#e2e9f3; font-size:12px; line-height:1; padding:6px 8px 6px 10px; border-radius:16px; display:inline-flex; align-items:center; gap:6px; cursor:pointer; position:relative; }
.video-meta-chips .chip:hover { background:#2b3e54; border-color:#3d5166; }
.video-meta-chips .chip:active { background:#1c2835; }
.video-meta-chips .chip .remove { font-size:14px; line-height:1; opacity:.7; }
.video-meta-chips .chip:hover .remove { opacity:1; }
.video-meta-chips .chips-input { background:#151d27; border:1px dashed #334457; color:var(--text); padding:6px 8px; border-radius:8px; font-size:12px; min-width:140px; max-width:100%; outline:none; }
.video-meta-chips .chips-input:focus { border-color:var(--accent); box-shadow:0 0 0 2px rgba(79,140,255,.28); }
.video-meta-chips .chips-hint { font-size:11px; }
.file-info-grid .fi-row:hover { background:rgba(255,255,255,0.04); }

.scrubber-track {
  position: relative;
  height: 10px;
  border-radius: 6px;
  background: linear-gradient(90deg, rgba(255,255,255,0.14), rgba(255,255,255,0.1));
  overflow: hidden;
  cursor: pointer;
}

/* Legacy markers layer (scene ticks) */
#timelineMarkers.timeline-markers-layer {
  position: absolute;
  inset: 0;
  pointer-events: none;
  z-index: 3;
}
#timelineMarkers.timeline-markers-layer .marker-tick {
  position: absolute;
  top: 0;
  width: 4px;
  height: 100%;
  background: rgba(255,255,255,0.75);
  mix-blend-mode: screen;
}

#timelineMarkers.timeline-markers-layer .intro-marker-tick {
  position: absolute;
  top: 0;
  width: 6px;
  height: 100%;
  background: linear-gradient(180deg, #ffb000, #ff7a00);
  box-shadow: 0 0 6px rgba(255, 122, 0, 0.6);
  border-radius: 3px;
  border: 1px solid rgba(0,0,0,0.12);
  mix-blend-mode: normal;
}

/* Detached heatmap band above scrubber */
.scrubber-heatmap-band {
  position: relative;
  height: 26px; /* taller for visibility */
  margin-bottom: 6px;
  border-radius: 6px;
  background: linear-gradient(to bottom, rgba(255,255,255,0.08), rgba(255,255,255,0.02));
  overflow: hidden;
  pointer-events: none;
  display: flex;
  align-items: stretch;
}
.scrubber-heatmap-band.hidden { display:none !important; }
.scrubber-heatmap-band .timeline-heatmap,
.scrubber-heatmap-band .timeline-heatmap-canvas {
  position:absolute;
  inset:0;
}
.scrubber-heatmap-band .timeline-heatmap { mix-blend-mode:soft-light; opacity:.9; }
.scrubber-heatmap-band .timeline-heatmap-canvas { opacity:.95; }

/* Markers list */
.markers-list { display:flex; flex-direction:column; gap:4px; font-size:12px; }
/* Default: allow the markers list to grow naturally (no internal scroll) so
   the page will only scroll if the overall accordion doesn't fill available
   space. When the accordion fills the sidebar, JS will add
   `.accordion--fills` to the accordion and the markers list becomes
   constrained and scrollable. */
.markers-list {
  max-height: none;
  overflow-y: visible;
  padding-right: 4px;
  overscroll-behavior: contain;
}

/* When the accordion fills the sidebar, enable internal scrolling for
   the markers list and cap its height to the available space. JS will also
   set an inline max-height for pixel-perfect sizing, but this rule acts as
   a graceful fallback. */
.player-split .player-sidebar .accordion.accordion--fills .markers-list {
  max-height: calc(100% - 120px); /* fallback estimate */
  overflow-y: auto;
  padding-right: 8px; /* space for scrollbar */
}
/* Thin scrollbar styling (WebKit) */
.markers-list::-webkit-scrollbar { width: 8px; }
.markers-list::-webkit-scrollbar-track { background: rgba(255,255,255,0.04); border-radius: 4px; }
.markers-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.22); border-radius: 4px; }
.markers-list::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.32); }
.marker-row { display:flex; align-items:center; gap:6px; background:#121c29; border:1px solid #1e2b3a; padding:4px 6px; border-radius:6px; }
.marker-row:hover { border-color:#2f4760; background:#162435; }
.marker-row button.marker-remove { background:none; border:none; color:#c74f4f; cursor:pointer; font-size:14px; line-height:1; padding:2px 4px; }
.marker-row button.marker-remove:hover { color:#ff6b6b; }
.marker-time-input { width:84px; font-family:monospace; font-size:12px; padding:3px 6px; border:1px solid #2a3a50; background:#0f1621; color:#d9e2ec; border-radius:4px; }
.marker-time-input:focus { outline:1px solid #4f8cff; border-color:#4f8cff; }
.marker-jump { background:#203246; border:1px solid #31465e; color:#d5e2f2; padding:2px 6px; border-radius:4px; cursor:pointer; font-size:11px; }
.marker-jump:hover { background:#2a3e58; }
.marker-btn-icon { display:inline-flex; align-items:center; justify-content:center; padding:2px 4px; background:transparent; border:1px solid transparent; border-radius:4px; color:#d5e2f2; line-height:1; }
.marker-btn-icon svg { display:block; pointer-events:none; }
.marker-btn-icon.marker-jump { background:#203246; border-color:#31465e; }
.marker-btn-icon.marker-jump:hover { background:#2a3e58; }
.marker-btn-icon.marker-remove { background:none; border:none; color:#c74f4f; }
.marker-btn-icon.marker-remove:hover { color:#ff6b6b; }
.markers-empty { font-size:12px; opacity:.6; padding:4px 2px; }

.marker-row--intro {
  background: linear-gradient(90deg, rgba(255,186,0,0.07), rgba(255,122,0,0.04));
  border-left: 4px solid #ff9800;
  padding-left: 8px;
  order: 0; /* keep intro markers in normal flow */
}
.marker-row--intro .marker-jump {
  background: rgba(255,160,40,0.12);
  border: 1px solid rgba(255,160,40,0.18);
}

/* Outro (outro-begin) marker: visually distinct and pinned to bottom of list */
.marker-row--outro {
  background: linear-gradient(90deg, rgba(0,186,255,0.07), rgba(0,122,255,0.04));
  border-left: 4px solid #0098ff;
  padding-left: 8px;
  order: 999; /* show at bottom of the flex column */
}
.marker-row--outro .marker-jump {
  background: rgba(0,160,255,0.12);
  border: 1px solid rgba(0,160,255,0.18);
}

/* Outro begin marker tick (timeline tick) */
.outro-marker-tick {
  position: absolute;
  top: 0;
  width: 6px;
  height: 100%;
  background: linear-gradient(180deg, #00b0ff, #007aff);
  box-shadow: 0 0 6px rgba(0,122,255,0.6);
  border-radius: 3px;
  border: 1px solid rgba(0,0,0,0.12);
  mix-blend-mode: normal;
}
.scrubber-track:hover .scrubber-progress { filter: brightness(1.15); }
.scrubber-track:hover .scrubber-handle { transform: translate(-50%, -50%) scale(1); opacity:1; }
.scrubber-buffer {
  position: absolute;
  left:0; top:0; bottom:0;
  background: rgba(255,255,255,.28);
  width:0%;
  transition: width .25s linear;
  opacity:.4;
}
.scrubber-progress {
  position:absolute;
  left:0; top:0; bottom:0;
  width:0%;
  background: linear-gradient(90deg, #3daaf9, #6679ff 45%, #9a6bff);
  box-shadow: 0 0 0 1px rgba(255,255,255,.15) inset, 0 1px 2px rgba(0,0,0,.45);
  transition: width .08s linear;
}
.scrubber-handle {
  position:absolute;
  top:50%;
  left:0%;
  width:16px;
  height:16px;
  border-radius:50%;
  background:linear-gradient(145deg,#fff,#d5e2ff);
  box-shadow:0 2px 6px rgba(0,0,0,.5),0 0 0 2px rgba(0,0,0,.4),0 0 0 1px rgba(255,255,255,.3) inset;
  transform:translate(-50%, -50%) scale(.65);
  opacity:0;
  transition:.18s ease;
  pointer-events:none;
}
.player-scrubber-bar:hover .scrubber-handle { opacity:1; }

/* Scene ticks */
.scrubber-scenes {
  position:absolute;
  left:0; top:0; bottom:0; right:0;
  pointer-events:none;
  mix-blend-mode:screen;
}
.scrubber-scenes span {
  position:absolute;
  top:0; bottom:0;
  width:2px;
  background:linear-gradient(to bottom, rgba(255,255,255,.85), rgba(255,255,255,.15));
  opacity:.55;
}

.scrubber-scenes .intro-scrubber-marker {
  width:4px;
  background: linear-gradient(180deg, #ffb000, #ff7a00);
  box-shadow: 0 0 6px rgba(255,122,0,0.6);
  border-radius:2px;
  opacity: 1;
}

/* Integrated heatmap inside scrubber track */
.scrubber-track .timeline-heatmap,
.scrubber-track .timeline-heatmap-canvas {
  pointer-events: none;
}
.scrubber-track .timeline-heatmap { mix-blend-mode: soft-light; opacity:.75; }
.scrubber-track .timeline-heatmap-canvas { opacity:.85; }
.scrubber-time { font-variant-numeric: tabular-nums; letter-spacing:.4px; text-shadow:0 1px 2px rgba(0,0,0,.7); font-weight:500; }

@media (max-width: 900px) {
  .player-scrubber-bar { padding: 12px 16px 16px; }
  #playerTitle.player-title { max-width: 60vw; }
}
@media (max-width: 640px) {
  .player-scrubber-bar { padding: 10px 12px 14px; }
  #playerTitle.player-title { max-width: 70vw; font-size:12px; }
}
.player-main { position: relative; }

.video-stage {
  position: relative;
  display: block;
  width: 100%;
  background: #000;
}

.video-el {
  display: block;
  width: 100%;
  height: calc(100vh - var(--header-h));
  max-height: calc(100vh - var(--header-h));
  background: #000;
  aspect-ratio: 16/9;
  object-fit: contain;
}

/* Overlay */
.player-overlay {
  position: absolute;
  left: 0;
  right: 0;
  bottom: 0;
  padding: 14px 10px 6px;
  display: flex;
  flex-direction: column;
  gap: 6px;
  pointer-events: none;
  background: linear-gradient(to top, rgba(0, 0, 0, 0.55), rgba(0, 0, 0, 0));
}

.player-overlay .overlay-inner {
  position: relative;
  display: flex;
  flex-direction: column;
  gap: 10px;
  pointer-events: auto;
  animation: accFade .25s ease;
}

.timeline-overlay {
  position: relative;
  height: 13px;
  border-radius: 4px;
  background: rgba(12, 18, 30, 0.55);
  backdrop-filter: blur(2px);
  overflow: hidden;
  cursor: pointer;
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.45);
  border: 1px solid rgba(255, 255, 255, 0.07);
}

.timeline-overlay:focus-visible {
  outline: 2px solid var(--accent);
  outline-offset: 2px;
}

.timeline-heatmap,
.timeline-heatmap-canvas,
.timeline-progress,
.timeline-markers {
  position: absolute;
  inset: 0;
}

.timeline-heatmap {
  background-position: left center;
  background-size: 100% 100%;
  opacity: .85;
  mix-blend-mode: soft-light;
}

.timeline-heatmap-canvas {
  width: 100%;
  height: 100%;
  pointer-events: none;
  opacity: .95;
}

.timeline-progress {
  width: 0%;
  background: linear-gradient(90deg, rgba(79, 140, 255, 0.65), rgba(79, 140, 255, 0.25));
  mix-blend-mode: screen;
  transition: width .12s linear;
}

.timeline-markers {
  pointer-events: none;
}

.controls-overlay {
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: 6px;
  background: rgba(14, 19, 30, 0.74);
  backdrop-filter: blur(3px) saturate(130%);
  border: 1px solid rgba(255, 255, 255, 0.10);
  border-radius: 7px;
  padding: 3px 7px;
  box-shadow: 0 3px 14px -3px rgba(0, 0, 0, 0.6);
  flex-wrap: wrap;
  min-height: 30px;
  font-size: 12px;
}

.controls-overlay:hover {
  background: rgba(18, 24, 36, 0.84);
}

.controls-overlay .btn-sm {
  --accent: #4f8cff;
}

.time-display {
  font-size: 12px;
  color: var(--muted, #94a2c7);
  display: flex;
  align-items: center;
  gap: 4px;
  font-variant-numeric: tabular-nums;
}

.player-controls {
  display: flex;
  align-items: center;
  gap: 10px;
}

.player-controls .vol-slider {
  width: 130px;
  height: 4px;
  background: #1e2a3e;
  border-radius: 4px;
  appearance: none;
  outline: none;
  cursor: pointer;
}

.player-controls .vol-slider::-webkit-slider-thumb {
  appearance: none;
  width: 14px;
  height: 14px;
  border-radius: 50%;
  background: var(--accent, #4f8cff);
  border: 2px solid #0d121d;
  box-shadow: 0 0 0 2px rgba(0, 0, 0, 0.4);
}

.player-controls .vol-slider:active::-webkit-slider-thumb {
  transform: scale(0.92);
}

.rate-select-wrap {
  min-width: 78px;
}

.utility-buttons {
  display: inline-flex;
  align-items: center;
  gap: 6px;
  margin-left: 6px;
}

.utility-buttons .btn-sm {
  background: #1d2a3d;
}

.utility-buttons .btn-sm:hover {
  background: #233348;
}

.sprite-preview {
  position: absolute;
  left: 8px;
  width: 240px;
  height: 135px;
  background: #111 center/cover no-repeat;
  border: 1px solid rgba(255, 255, 255, 0.18);
  border-radius: 8px;
  display: none;
  pointer-events: none;
  box-shadow: 0 4px 18px rgba(0, 0, 0, 0.45);
  z-index: 6;
  opacity: 0.95;
}

/* Compact adjustments when sidebar collapsed */
#playerLayout[data-sidebar-collapsed="true"] .player-overlay {
  padding-bottom: 4px;
}

/* Responsive tweaks */
/* Keep sidebar on the left; on narrower screens shrink width instead of stacking */

/* === Viewport-Fit Player (no scroll) === */

/* (Removed duplicate #player-panel height block; earlier flex rule governs layout now) */

#player-panel .player-main {
  flex: 1;
  display: flex;
  flex-direction: column;
  min-height: 0;
}

#player-panel .player-stage-simple {
  flex: 1;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: 6px;
  min-height: 0; /* allow flex child (video) to size fully */
}
/* Panel-specific .video-el override removed: unified calc-based height applies */

@media (max-height: 760px) {

  /* Tighten spacing on shorter viewports */
  #player-panel .player-shell {
    gap: 6px;
    padding: 2px 6px 8px;
  }

  #player-panel .player-stage-simple {
    padding: 4px;
  }

  .player-stage-simple .video-el {
    border-radius: 8px;
  }

  #player-panel .player-bar-simple {
    padding: 8px 10px;
  }
}

@media (max-height: 560px) {

  /* Compress controls further and shrink fonts */
  #player-panel .player-bar-simple {
    padding: 6px 8px;
    gap: 6px;
    font-size: 11px;
  }

  #player-panel .player-bar-simple button.btn-sm {
    padding: 4px 6px;
    font-size: 11px;
  }

  #player-panel .player-bar-simple .time-display {
    font-size: 11px;
  }

  .vol-slider {
    width: 90px;
  }
}

@media (max-width: 760px) {
  .player-layout {
    gap: 10px;
  }

  .player-video {
    border-radius: 10px;
  }
}

@media (max-width: 640px) {
  .player-overlay {
    padding: 10px 6px 4px;
  }

  .player-controls {
    gap: 6px;
  }

  .player-controls .vol-slider {
    width: 92px;
  }

  .player-title {
    font-size: 16px;
  }

  .controls-overlay {
    padding: 2px 6px;
    gap: 4px;
  }
}

/* Fullscreen refinements */
:fullscreen .player-video,
.player-video:fullscreen {
  border-radius: 0;
  max-height: 100vh;
}

:fullscreen .player-overlay {
  background: linear-gradient(to top, rgba(0, 0, 0, 0.65), rgba(0, 0, 0, 0));
}

/* High contrast / prefers-reduced-motion adjustments */
@media (prefers-reduced-motion: reduce) {
  .timeline-progress {
    transition: none;
  }

  .player-overlay .overlay-inner {
    animation: none;
  }
}

@media (forced-colors: active) {
  .controls-overlay {
    border: 1px solid CanvasText;
  }

  .timeline-overlay {
    border: 1px solid CanvasText;
  }
}

/* Toast / notification system */
#toastHost {
  position: fixed;
  top: 20px;
  right: 20px;
  display: flex;
  flex-direction: column;
  gap: 10px;
  z-index: 1000;
  pointer-events: none;
  /* clicks pass through when between toasts */
}

/* Destructive / danger button variant (used for Clear All) */
.btn-danger,
.btn.btn-danger,
button.btn-danger {
  background: linear-gradient(135deg, #b91c1c, #dc2626);
  color: #fff;
  border: 1px solid rgba(255, 255, 255, 0.12);
  box-shadow: 0 2px 4px -2px rgba(0, 0, 0, 0.5);
}

.btn-danger:hover {
  background: linear-gradient(135deg, #dc2626, #ef4444);
}

.btn-danger:active {
  background: #991b1b;
}

.btn-danger:disabled {
  opacity: .55;
  cursor: not-allowed;
}

/* Capability banner extracted from inline style */
.capability-banner {
  margin: 8px 0 12px;
  padding: 10px 12px;
  border: 1px solid rgba(255, 255, 255, 0.15);
  border-radius: 8px;
  background: #221b12;
  color: #f7d382;
  font-size: 13px;
  line-height: 1.4;
}

.toast {
  font-size: 13px;
  line-height: 1.3;
  background: #4f8cff;
  color: #fff;
  padding: 10px 14px;
  border-radius: 8px;
  box-shadow: 0 4px 16px -4px rgba(0, 0, 0, 0.4);
  animation: toastIn 0.32s ease;
  position: relative;
  pointer-events: auto;
  /* allow hover for potential future actions */
  max-width: 320px;
}

.toast.is-success {
  background: #22c55e;
}

.toast.is-error {
  background: #ef4444;
}

.toast.is-info {
  background: #4f8cff;
}

@keyframes toastIn {
  from {
    opacity: 0;
    transform: translateY(-6px);
  }

  to {
    opacity: 1;
    transform: translateY(0);
  }
}

.toast.fade-out {
  opacity: 0;
  transition: opacity .25s ease;
}

@media (prefers-reduced-motion: reduce) {
  .toast {
    animation: none;
  }
}

/* 18. Registry & Auto-Tag (appended) */
.registry-flex{display:flex;gap:32px;align-items:flex-start;flex-wrap:wrap;margin-top:8px;}
.registry-column{flex:1 1 340px;min-width:300px;background:#1b1f28;border:1px solid #273140;padding:12px;border-radius:10px;box-shadow:0 2px 6px -2px rgba(0,0,0,.55);}
.registry-column h3{margin:0 0 6px;font-size:15px;letter-spacing:.3px;}
.registry-toolbar{display:flex;flex-wrap:wrap;gap:6px;margin-bottom:6px;}
.registry-list{max-height:420px;overflow:auto;border:1px solid #273140;border-radius:6px;background:#141a22;padding:4px;display:flex;flex-direction:column;gap:4px;}
.registry-item{padding:6px 8px;border:1px solid #273140;border-radius:5px;display:flex;justify-content:space-between;align-items:center;gap:8px;font-size:13px;background:#1d2530;cursor:pointer;line-height:1.2;}
.registry-item[data-selected="1"]{background:#20344e;border-color:#335a8a;}
.registry-item .ri-name{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.registry-item .ri-count{opacity:.55;font-size:11px;}
.autotag-table{width:100%;border-collapse:collapse;}
.autotag-table th,.autotag-table td{padding:6px 8px;border-bottom:1px solid #1f2833;font-size:12px;vertical-align:top;text-align:left;}
.autotag-table thead th{background:#18202a;position:sticky;top:0;z-index:1;}
.autotag-table tbody tr:hover{background:#1b2736;}
.w-240{width:240px;}
.w-200{width:200px;}

/* Accordion animations: use max-height + opacity for a reliable, CSS-only transition
   that doesn't require JS-driven measurements. We toggle the `.open` class on the
   .acc-item and .acc-panel to animate. Keep `.hidden` as a graceful no-JS fallback. */
.accordion .acc-panel {
  max-height: 0; /* collapsed */
  overflow: hidden;
  opacity: 0;
  padding-top: 0;
  padding-bottom: 0;
  transition: max-height 260ms cubic-bezier(.2,.9,.2,1), opacity 180ms ease, padding 200ms ease;
}
.accordion .acc-panel.open {
  /* large enough to cover most content; using max-height avoids layout thrashing */
  max-height: 640px;
  opacity: 1;
  padding-top: 10px;
  padding-bottom: 10px;
}

/* When JS is disabled we still support hiding via `.hidden` */
.accordion .acc-panel.hidden { display: none !important; }

/* Header caret rotation: rotate when the item is open or when aria-expanded is true */
.accordion .acc-header .acc-header__icon {
  display: inline-block;
  width: 16px; height: 16px;
  margin-right: 8px;
  vertical-align: middle;
  transition: transform 220ms ease, opacity 150ms ease;
  color: inherit;
  /* default: point right (icon originally points left in the sprite) */
  transform: rotate(180deg);
}
.accordion .acc-header .acc-header__icon use,
.accordion .acc-header .acc-header__icon path { fill: currentColor; }

/* rotate the svg caret when open/expanded */
.acc-item.open .acc-header .acc-header__icon,
.acc-header[aria-expanded="true"] .acc-header__icon {
  /* open: point down */
  transform: rotate(270deg);
}
