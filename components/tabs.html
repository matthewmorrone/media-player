<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Tabs Component</title>
  <style>
    :root {
      --tab-fg: #1f2937;
      --tab-bg: #f8fafc;
      --tab-accent: #2563eb;
      --tab-muted: #94a3b8;
      --panel-bg: #ffffff;
      --border: #e5e7eb;
      --radius: 8px;
    }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", sans-serif;
      background: var(--tab-bg);
      color: var(--tab-fg);
      line-height: 1.5;
    }
    .tabs {
      max-width: 880px;
      margin: 24px auto;
      padding: 0 16px;
    }
    .tabs__list {
      display: flex;
      gap: 4px;
      border-bottom: 1px solid var(--border);
      overflow-x: auto;
      scrollbar-width: thin;
    }
    .tabs__tab {
      appearance: none;
      background: transparent;
      border: 0;
      border-bottom: 2px solid transparent;
      padding: 12px 14px;
      margin: 0;
      color: var(--tab-muted);
      font: inherit;
      cursor: pointer;
      white-space: nowrap;
    }
    .tabs__tab[aria-selected="true"] {
      color: var(--tab-fg);
      border-bottom-color: var(--tab-accent);
      font-weight: 600;
    }
    .tabs__tab:focus-visible {
      outline: 2px solid var(--tab-accent);
      outline-offset: 2px;
      border-radius: 4px;
    }
    .tabs__panel {
      background: var(--panel-bg);
      border: 1px solid var(--border);
      border-top: 0;
      border-radius: 0 0 var(--radius) var(--radius);
      padding: 16px;
    }
    [hidden] {
      display: none !important;
    }
  </style>
</head>
<body>
  <div class="tabs" data-tabs>
    <div class="tabs__list" role="tablist" aria-label="Media tabs">
      <button class="tabs__tab"
              id="tab-overview"
              role="tab"
              aria-selected="true"
              aria-controls="panel-overview"
              tabindex="0">Overview</button>
      <button class="tabs__tab"
              id="tab-tracks"
              role="tab"
              aria-selected="false"
              aria-controls="panel-tracks"
              tabindex="-1">Tracks</button>
      <button class="tabs__tab"
              id="tab-settings"
              role="tab"
              aria-selected="false"
              aria-controls="panel-settings"
              tabindex="-1">Settings</button>
    </div>

    <section id="panel-overview" class="tabs__panel" role="tabpanel" aria-labelledby="tab-overview" tabindex="0">
      <!-- ...existing code... -->
      <h2>Overview</h2>
      <p>Summary and metadata for the current media.</p>
      <!-- ...existing code... -->
    </section>

    <section id="panel-tracks" class="tabs__panel" role="tabpanel" aria-labelledby="tab-tracks" tabindex="0" hidden>
      <!-- ...existing code... -->
      <h2>Tracks</h2>
      <p>Audio/Subtitles tracks management.</p>
      <!-- ...existing code... -->
    </section>

    <section id="panel-settings" class="tabs__panel" role="tabpanel" aria-labelledby="tab-settings" tabindex="0" hidden>
      <!-- ...existing code... -->
      <h2>Settings</h2>
      <p>Playback and interface preferences.</p>
      <!-- ...existing code... -->
    </section>
  </div>

  <script>
    (function () {
      function initTabs(root) {
        const tablist = root.querySelector('[role="tablist"]');
        const tabs = Array.from(root.querySelectorAll('[role="tab"]'));
        const panels = Array.from(root.querySelectorAll('[role="tabpanel"]'));
        const idToPanel = new Map(panels.map(p => [p.id, p]));
        const idToTab = new Map(tabs.map(t => [t.id, t]));

        function setSelected(nextTab, { setFocus = true } = {}) {
          tabs.forEach(tab => {
            const selected = tab === nextTab;
            tab.setAttribute('aria-selected', String(selected));
            tab.tabIndex = selected ? 0 : -1;
            const panelId = tab.getAttribute('aria-controls');
            const panel = idToPanel.get(panelId);
            if (panel) panel.hidden = !selected;
          });
          if (setFocus) nextTab.focus();
          // Optional: dispatch event for external listeners
          root.dispatchEvent(new CustomEvent('tabs:change', {
            bubbles: true,
            detail: { tabId: nextTab.id, panelId: nextTab.getAttribute('aria-controls') }
          }));
        }

        // Click to activate
        tabs.forEach(tab => {
          tab.addEventListener('click', (e) => {
            e.preventDefault();
            setSelected(tab, { setFocus: true });
          });
        });

        // Keyboard navigation
        tablist.addEventListener('keydown', (e) => {
          const current = document.activeElement;
          if (!tabs.includes(current)) return;

          let idx = tabs.indexOf(current);
          if (e.key === 'ArrowRight') {
            e.preventDefault();
            const next = tabs[(idx + 1) % tabs.length];
            setSelected(next, { setFocus: true });
          } else if (e.key === 'ArrowLeft') {
            e.preventDefault();
            const next = tabs[(idx - 1 + tabs.length) % tabs.length];
            setSelected(next, { setFocus: true });
          } else if (e.key === 'Home') {
            e.preventDefault();
            setSelected(tabs[0], { setFocus: true });
          } else if (e.key === 'End') {
            e.preventDefault();
            setSelected(tabs[tabs.length - 1], { setFocus: true });
          } else if (e.key === 'Enter' || e.key === ' ') {
            e.preventDefault();
            setSelected(current, { setFocus: true });
          }
        });

        // Ensure initial state is consistent (only one selected)
        const initiallySelected = tabs.find(t => t.getAttribute('aria-selected') === 'true') || tabs[0];
        setSelected(initiallySelected, { setFocus: false });
      }

      document.addEventListener('DOMContentLoaded', () => {
        document.querySelectorAll('[data-tabs]').forEach(initTabs);
      });
    }());
  </script>
</body>
</html>